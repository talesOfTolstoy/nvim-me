\documentclass[11pt, a4paper]{article}
\usepackage[utf8]{inputenc}
\usepackage{graphicx}
\graphicspath{ {images/} }
\usepackage{sectsty}
\usepackage{float}
\usepackage{xcolor}
\usepackage{soul}
\sethlcolor{green}
\usepackage[demo]{graphicx}
\usepackage{caption}
\usepackage{subcaption}
\usepackage{geometry}


\newgeometry{top=0.1cm,bottom=0.72in}
% \setlength{\topmargin}{0in}
\title{\textbf{MACE40122 Advanced Computational Fluid Dynamics: DNS Laboratory Report}}
\author{Borja Díaz-Guardamino Sobrín\\ Student ID: 10371885}
\date{March 2022}

\sectionfont{\fontsize{18}{18}\selectfont}

\begin{document}
\maketitle
% \section{Executive Summary}
\section*{\centering Executive Summary}



This report gives an introduction into the main characteristics of the Direct Numerical Simulation (DNS) and Lattice-Boltzmann (LBM) Methods for fluid flow analysis. Furthermore, the Reynolds Decomposition is explained and derived in detail, providing a clear understanding of the origin and significance of the Reynolds Stresses. Moreover, two flows analysed via LBM were compared to a previous DNS simulation by Kim et al., which was used as reference due to its high level of physical exactness.\\

The major findings of this analysis were the fact that employing a Periodic Inlet boundary condition to a channel flow provides accurate results that match those of the DNS simulation. In addition, using Synthetic Eddy Method as the inlet boundary condition has an inherent error due to it using time-averaged velocity profiles for the flow initialisation. Lastly, the boundary layers for both PI and SEM flows were examined, further reaffirming the validity of the above findings.

\section{Introduction}
For the making of this report students were provided with three different data files, each corresponding to a specific type of simulation. The first file was the results of the last time-step of a Direct Numerical Simulation (DNS) carried out by Kim et al. [1]. The other two simulations were carried out using the Lattice-Boltzmann Method (LBM), each having different boundary conditions.\\

The DNS simulation method is such that the Navier-Stokes equations are solved without the implementation of any turbulence model, meaning that the length and time scales ought to be solved entirely [2]. This ultimately means that the computational cost and time of the simulation will be elevated, but so will the accuracy of the results.\\ 

On the other hand, the Lattice-Boltzmann Method is one such that the time, length and velocity scales are discretised, only allowing the different sets of particles to displace in a predetermined number of directions (i.e., in a lattice), with a set time-step and velocity. This discretisation ultimately constitutes a simplification of Boltzmann's transport equation [3], therefore giving rise to simulation errors. The accuracy could be raised by increasing the number of possible directions within the lattice, which would consequently elevate time and cost.\\

The first one of the LBM simulations was performed using a periodic type of inlet, meaning that the channel's outlet corresponds to its own inlet, i.e., the flow loops around the channel. The other LBM simulation provided was carried out using Synthetic Eddy Method (SEM). In the latter type, the inlet instantaneous velocity is given as a time-averaged profile.\\


Furthermore, the physical environment under which the simulations were performed saw a span-wise open channel flow (no boundary condition ---open--- along the z-direction),

\newgeometry{top= 0.72in,bottom=0.72in}
with solid walls framing the top and bottom margins of the flow.\\



The aim of the laboratory session was to perform the post-processing of data from previous simulations with the objective to compare them (LBM vs. DNS) and observe the difference between them. This difference arises as a result of the intrinsic physical simplification of the LBM method, which is in turn significantly cheaper (computationally) than DNS. In order to conduct the comparison, the DNS was used as reference because of its high accuracy. \\

Morover, the effect of the different boundary conditions used in each of the simulations will be studied closely, observing their effect on the nature of the flow.\\

In order to perform the post-processing, students were provided with a series of already-existing MATLAB scripts. This set contained a collection of functions (used for loading the data, and making specific kinds of plots), and a main script (where all the functions were recalled and executed).\\

The variables taken into account to perform the post-processing were the instantaneous and time-averaged velocities (in all three directions), as well as their indexed product. These velocities are taken from the data output of the last time-step of each of the simulations.

\subsection{Reynolds Stresses Derivation}
First, the Navier-Stokes Equations for steady two-dimensional flow shall be shown.\\
\begin{equation}
\frac{\partial (\rho \tilde{U} \tilde{U})}{\partial x} + \frac{\partial(\rho \tilde{U} \tilde{V})}{\partial y} = -\frac{\partial \tilde{P}}{\partial x} + \frac{\partial}{\partial x}{\left( \nu \frac{\partial \tilde U}{\partial x} \right)} + \frac{\partial}{\partial y}{\left( \nu \frac{\partial \tilde U}{\partial y} \right)}
\end{equation}

Recalling the main principle of the Reynolds decomposition that the flow's instantaneous velocity at any point ($\tilde{U}$, $\tilde{V}$) can be expressed as the sum of the overall time-averaged velocity ($U$, $V$) plus a velocity fluctuation specific to that point ($u'$, $v'$), as seen below.

\begin{equation}
    \tilde{U} = U + u', \;\;\;\;\;\;\;\; \tilde{V} = V + v'
\end{equation}

Having a closer look at the momentum terms in the left-hand side of equation $(1)$, a substitution can be made inputting equation $(2)$.The result of the substitution is as follows,

\begin{equation}
    \overline{\partial_{x}(U+u')^2} \;\;\rightarrow\;\; \partial_{x}(\overline{U^2}+\overline{2Uu'}+\overline{u'^2})\;\; \rightarrow\;\; \partial_{x}(U^2 + \overline{u'^2})
\end{equation}

and,

\begin{equation}
    \overline{\partial_{y}(U+u')(V+v')} \;\;\rightarrow\;\; \partial_{y}(\overline{UV}+\overline{u'V}+\overline{Uv'}+\overline{u'v'})\;\; \rightarrow\;\; \partial_{y}(UV + \overline{u'v'})
\end{equation}

where the $\overline{u'^2}$ and $\overline{u'v'}$ terms correspond to the Reynolds stresses of the horizontal and vertical components of the stream-wise velocity, respectively. In index (Einstein) notation this can be rewritten as,

\begin{equation}
    \overline{u'_{i}u'_{j}},\;\; for\;\; i,j=x,y
\end{equation}

Recalling equation $(2)$, and introducing a new term for the Reynolds Stresses such that $Re_{ij}=\overline{u'_{i}u'_{j}}$, we obtain an equation for these as a function of the instantaneous velocities ($\tilde{U}\tilde{V}$, or $\tilde{U_i}\tilde{U_j}$ in Einstein notation) and the time-averaged velocities ($UV$, or $U_iU_j$).

\begin{equation}
    Re_{ij}=\overline{u'_{i}u'_{j}}=U_iU_j-\tilde{U_i}\tilde{U_j} \;\; for \;\; i,j=x,y
\end{equation}

Note that, for simplicity, this derivation was performed for a two-dimensional steady flow, meaning that if a third coordinate was required (i.e., z) the result would remain unchanged but for an additional index $i,j=x,y,z$ (the span-wise component of the velocity)\\

\section{Results and Discussion}
\subsection{Flow Feature Analysis}

In order to characterise the turbulence, Figure \ref{fig:Figure 1} will be used, as it shows the flow across the periodic inlet channel with high resolution.

\begin{figure} [H]
    \centering
    \includegraphics[scale=0.6, height=3cm, width=15cm]{PerInsVelZ16.png}
    \caption{Periodic Channel Instantaneous Stream-wise Velocity at z=1.6 m}
    \label{fig:Figure 1}
\end{figure}


The first thing that is noticed are the high levels of vorticity and rotational velocity in the flow. Concise examples can be seen along the entire span of the image, in the ranges between $0<y<0.5$ and $1.5<y<2$, i.e., in the near wall region (where the viscous effects are very noticeable). Moreover, it can be seen that, depending on the x-location, the flow will have a fluctuating range of velocities, indicating its high levels of unsteadiness.\\

If the beginning and the end points of the channel are observed, it can be seen how the portion of the flow represented in yellow (meaning high velocity, and hence high kinetic energy) diminishes along the x-direction. This is a direct result of energy dissipation into heat or internal energy as a consequence of flow viscosity.\\

Furthermore, the stochasticity of the turbulence can also be appreciated. If the flow is looked at in specific locations of x, it can be appreciated how the turbulence patterns never exactly repeat themselves (nevertheless, they could be similar), therefore constituting a semi-deterministic state.\\

Regarding the turbulence spectrum of the flow, Figure \ref{fig:Figure 2} (a) shows it for the mid-height ($y=1$) point along the entire channel, i.e., approximately where the mean flow conditions are located.

% \begin{figure} [H]
% \begin{subfigure}{.5\textwidth}
%     \centering
%     \includegraphics[scale=0.45,height=5cm]{TurbSpecY1.png}
% \end{subfigure}
% \begin{subfigure}{.5\textwidth}
%     \centering
%     \includegraphics[scale=0.7,height=5.1cm]{TurbSpecY005.png}
% \end{subfigure}
%     \caption{Turbulence Spectrum of the Stream-wise Flow at $y=1$ (a) and $y=0.05$ (b)}
%     \label{fig:Figure 2}
% \end{figure}

The blue lines represent the energy of the eddies as a function of the inverse of their size (meaning that their size tends to 0 as $x\rightarrow \infty$). The red lines are the inertial sub-range's empirical slope ($-5/3$), as found by Kolmogorov. The yellow lines mark the end of the production sub-range of the turbulence spectrums (determined roughly by the physical size of the problem) and the beginning of the aforementioned inertial sub-range. This line is known as the Integral Length Scale, and it represents the larger eddies in the simulation (which carry the largest amounts of energy).\\

The point at which the red line detaches from the blue one marks the start of the Kolmogorov Length Scale (dissipation sub-range). This is the region where the eddies are not large enough to withstand the effects of viscosity and therefore dissipate. Moreover, between the Kolmogorov and Integral Length Scales the Taylor Length Scale can be located, which is related to the isotropic motion of the flow.\\

In contrast, Figure \ref{fig:Figure 2} (b) shows the turbulence spectrum for a section of the flow located within its boundary layer.

A series of observations can be made from the comparison between Figures \ref{fig:Figure 2} (a) and (b). The first one being the start of the dissipation sub-range. In the latter the detachment of the red line from the blue one occurs earlier along x than in the former. This is purely a viscous effect. As the local Reynolds number of the flow at $y=0.05$ is lower than at $y=1$ due to its reduced stream-wise velocity (as seen in Figure \ref{fig:Figure 3}), the viscous forces have a considerably higher effect than at mean-flow. This translates into higher dissipation of kinetic energy.\\

In the case that the cell size was to be increased, this would increase the total simulated energy dissipation, as there would be an increased error in the computation as a direct result of the less-accurate discretisation of the fluid body.

In Figure \ref{fig:Figure 3} the vertical profile of the mean stream-wise velocity can be seen. The y-axis represents the vertical distance from the lower wall (in a log scale, so that the near-wall region can be appreciated in detail), and the data is taken at distances 1, 2, 3, 4, 5, and 6 metres along the length of the channel.

% \begin{figure} [H]
%     \centering
%     \includegraphics[scale=0.65]{PeriodicInlet_v_avP_profiles.png}
%     \caption{Vertical Profiles of Mean Stream-wise Velocity}
%     \label{fig:Figure 3}
% \end{figure}

As can be observed in Figure \ref{fig:Figure 3}, the main differences between the Periodic Inlet and the DNS simulations are subtle. They are most pronounced in the end-region of the boundary layer, and in the velocity climb towards the mean flow's velocity. These differences arise from a lack of accuracy due to the simplifications in the analysis method of the former simulation.\\

\subsection{Inlet Boundary Condition Analysis}

The main difference between the LBM simulations is a direct result of the inlet boundary conditions. In Figures \ref{fig:Figure 4} and \ref{fig:Figure 5} a comparison between boundary layers can be appreciated for both simulations.
\begin{figure} [H]
    \centering
    \includegraphics{u_yBL_SEM.png}
    \caption{SEM Flow Stream-wise Velocity Profile. Viewed in $XZ$ Plane at $y=0.027$ m}
    \label{fig:Figure 4}
\end{figure}

\begin{figure} [H]
    \centering
    \includegraphics[height=3cm]{u_yBL_PI.png}
    \caption{Periodic Inlet Flow Stream-wise Velocity Profile. Viewed in $XZ$ Plane at $y=0.05$}
    \label{fig:Figure 5}
\end{figure}

The view in the $XZ$ plane was chosen due to the lack of blockage effect of the walls, as the channel is open span-wise. This provides a more clear view of the unaffected turbulence.\\

In the SEM flow (Figure \ref{fig:Figure 4}), it can be observed how the flow starts with a clear pattern in the form of streamlines transitioning towards a fully turbulent boundary layer, which manifests in the latter end of the stream in a fully stochastic manner. On the other hand, in the Periodic Inlet simulation, as the flow is looping through the stream without having its momentum and energy properties affected, the fully turbulent regime is seen all throughout. Furthermore, it can be observed how the SEM flow has a more homogeneous velocity profile (better appreciated at larger $y$), as opposed to the Periodic Inlet flow due to its increased turbulence. Fundamentally, in the SEM flow a timeline of turbulence transition and development can be appreciated, whereas in the PI flow, only the last six metres of the simulation can be seen if it were to be a continuous non-periodic channel.\\

Moreover, the SEM flow does not provide valid results compared to the DNS simulation. This is due to the fact that it uses averaged velocity profiles as its inlet velocity condition. This is further explained at the end of this section.

A further characteristic difference of the boundary conditions is the length of each of the channels. The SEM channel is 20 metres long, and the PI channel is only 6. This difference arises from the fact that it would be unnecessary to elongate the PI domain further, as the turbulence inside it is roughly equal as it loops. Therefore there is no need to have it be as large as the SEM channel, which would significantly increase computational cost.\\

Moreover, applying the SEM boundary conditions to this simulation is erroneous, as the flow starts with an instantaneous velocity produced using time-averaged velocity profiles. This means that the flow at the start is not fully developed, increasing the error of the first stages of the simulation. For this reason, in the case that a solid cube was placed inside the channels for analysis, using the periodic inlet flow would be recommended, as the flow around the cube would always be fully developed.\\

\section{Conclusions}
In this report, a brief introduction into the Direct Numerical Simulation, and Lattice-Boltzmann Methods was provided, with further explanation of the specific inlet boundary conditions used in these analyses.\\

Furthermore, an extensive review was given of the differences between the DNS simulation carried out by Kim et al., and the simulations carried out by means of the Lattice-Boltzmann Method with Synthetic Eddie Method and Periodic Inlet Boundary Conditions.\\

Finally, a more profound insight was taken into the effect and validity of the aforementioned inlet boundary conditions used.\

\section*{References}
[1]: Kim, J. et al. (1987). \textit{Turbulence statistics in fully developed channel flow at low Reynolds Number}. Journal of Fluid Mechanics, vol. 177, pp. 133-166.\\

\noindent[2]: Orszag, S. (1970). \textit{Analytical Theories of Turbulence}. Journal of Fluid Mechanics, vol. 41, pp. 363–386.\\

\noindent [3]: Chen, S., Doolen, G. (1998). \textit{Lattice-Boltzmann Method for Fluid Flows}. Annual Review of Fluid Mechanics, vol. 30, pp. 329–364.
\end{document}
